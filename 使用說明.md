# DHCP Finder - 使用說明

## 專案概述

DHCP Finder 是一個功能完整的網路診斷工具，提供以下三大核心功能：

1. **DHCP伺服器掃描** - 掃描網路中的DHCP伺服器並顯示其IP和MAC地址
2. **網路介面卡資訊** - 列出本機所有網路介面卡的詳細資訊
3. **外網連線及網速測試** - 檢測外網連線狀態並測試網路速度

## 檔案結構

```
DHCP_finder/
├── main.py                 # 主程式檔案
├── requirements.txt        # Python依賴套件清單
├── README.md              # 專案說明文件
├── 使用說明.md            # 詳細使用說明（本檔案）
├── setup.py               # 安裝腳本
├── test_modules.py        # 模組測試腳本
├── run.bat                # 執行腳本
├── build.bat              # 編譯腳本
├── build_debug.bat        # 除錯版編譯腳本
├── setup_venv.bat         # 虛擬環境設置腳本
├── activate_venv.bat      # 虛擬環境啟動腳本
├── venv/                  # Python虛擬環境目錄
└── .vscode/               # VSCode配置目錄
    ├── launch.json        # 除錯配置
    ├── settings.json      # 編輯器設定
    └── tasks.json         # 任務配置
└── modules/               # 功能模組目錄
    ├── __init__.py
    ├── dhcp_scanner.py    # DHCP掃描模組
    ├── network_info.py    # 網路資訊模組
    └── internet_test.py   # 外網測試模組
```

## 安裝與執行

### 方法1：使用虛擬環境（推薦）

1. **設置虛擬環境**：
   ```bash
   setup_venv.bat
   ```
   這會自動創建虛擬環境並安裝所有依賴套件。

2. **啟動虛擬環境**：
   ```bash
   activate_venv.bat
   ```

3. **執行程式**：
   ```bash
   python main.py
   ```

### 方法2：VSCode開發環境

1. **開啟VSCode**：
   ```bash
   code .
   ```

2. **選擇Python解釋器**：
   - 按 `Ctrl+Shift+P`
   - 輸入 `Python: Select Interpreter`
   - 選擇 `./venv/Scripts/python.exe`

3. **執行程式**：
   - 按 `F5` 開始除錯
   - 或按 `Ctrl+F5` 直接執行
   - 或使用 `Ctrl+Shift+P` → `Tasks: Run Task` → `執行主程式`

### 方法3：直接執行Python腳本

1. **安裝Python依賴套件**：
   ```bash
   python -m pip install -r requirements.txt
   ```

2. **執行程式**：
   ```bash
   python main.py
   ```
   或者執行：
   ```bash
   run.bat
   ```

### 方法4：使用安裝腳本

1. **執行安裝腳本**：
   ```bash
   python setup.py
   ```

2. **按照提示完成安裝**

### 方法5：編譯成exe檔案

1. **編譯成exe**：
   ```bash
   build.bat
   ```

2. **執行編譯好的exe**：
   ```bash
   dist\DHCP_Finder.exe
   ```

## 功能說明

### 1. DHCP伺服器掃描

- **功能**：掃描當前網路中的DHCP伺服器
- **顯示資訊**：
  - DHCP伺服器IP地址
  - MAC地址
  - 網卡廠商資訊（如果可識別）
- **注意事項**：
  - 需要管理員權限以獲得最佳掃描效果
  - 某些防火牆可能會阻擋掃描功能

### 2. 網路介面卡資訊

- **功能**：列出本機所有網路介面卡的詳細資訊
- **顯示資訊**：
  - 介面名稱和狀態
  - IP地址和子網路遮罩
  - MAC地址
  - 網路速度和MTU
  - 預設閘道
  - 網路統計資訊（傳送/接收的資料量和封包數）

### 3. 外網連線測試

- **基本連線測試**：
  - 檢測外網連線狀態
  - 測試DNS解析功能
  - 顯示網路延遲
- **網速測試**：
  - 測試下載速度
  - 測試上傳速度
  - 顯示測試伺服器資訊

## 系統需求

- **作業系統**：Windows 10/11
- **Python版本**：3.8或更高版本
- **權限**：建議以管理員身份執行以獲得完整功能
- **網路**：需要網路連線以進行外網測試

## 依賴套件

- `psutil` - 系統和網路資訊獲取
- `scapy` - 網路封包處理
- `speedtest-cli` - 網速測試
- `requests` - HTTP請求處理
- `netifaces` - 網路介面資訊
- `pyinstaller` - 打包成exe檔案

## 故障排除

### 常見問題

1. **"No libpcap provider available" 警告**
   - 這是正常警告，不影響程式功能
   - 如需完整的封包捕獲功能，可安裝WinPcap或Npcap

2. **DHCP掃描無結果**
   - 確保以管理員身份執行
   - 檢查防火牆設定
   - 某些網路環境可能限制DHCP掃描

3. **網速測試失敗**
   - 檢查網路連線
   - 嘗試關閉VPN或代理
   - 某些防火牆可能阻擋測試

4. **編譯exe失敗**
   - 確保已安裝所有依賴套件
   - 嘗試使用 `build_debug.bat` 查看詳細錯誤訊息

### 除錯模式

如果遇到問題，可以：

1. **執行測試腳本**：
   ```bash
   python test_modules.py
   ```

2. **編譯除錯版本**：
   ```bash
   build_debug.bat
   ```

3. **查看詳細錯誤訊息**：
   除錯版本會顯示控制台視窗，可以看到詳細的錯誤訊息

## 注意事項

1. **權限要求**：建議以管理員身份執行以獲得完整功能
2. **防火牆設定**：某些功能可能需要防火牆允許網路存取
3. **網路環境**：在企業網路環境中，某些功能可能受到限制
4. **隱私保護**：網速測試會連接到外部伺服器，請注意隱私保護

## 技術支援

如果遇到問題，請：

1. 檢查本說明文件的故障排除章節
2. 執行測試腳本確認模組功能
3. 查看程式輸出的錯誤訊息
4. 確認系統需求和依賴套件是否正確安裝

## VSCode開發環境配置

本專案已完整配置VSCode開發環境，包含：

### 除錯配置 (launch.json)

- **DHCP Finder - 主程式**: 除錯主程式
- **DHCP Finder - 測試模組**: 除錯測試腳本
- **DHCP Scanner - 單獨測試**: 單獨測試DHCP掃描模組
- **Network Info - 單獨測試**: 單獨測試網路資訊模組
- **Internet Test - 單獨測試**: 單獨測試外網測試模組
- **DHCP Finder - 除錯模式**: 詳細除錯模式

### 任務配置 (tasks.json)

- **執行主程式**: 直接執行程式
- **執行測試**: 執行模組測試
- **安裝依賴套件**: 安裝requirements.txt中的套件
- **編譯成exe**: 編譯正式版exe
- **編譯除錯版exe**: 編譯除錯版exe
- **Pylint檢查**: 程式碼品質檢查
- **清理編譯檔案**: 清理build和dist目錄

### 編輯器設定 (settings.json)

- 自動使用虛擬環境中的Python解釋器
- 啟用Pylint程式碼檢查
- 設定程式碼格式化規則
- 配置檔案關聯和排除規則

### 使用方法

1. **開啟專案**: `code .`
2. **選擇解釋器**: VSCode會自動使用 `./venv/Scripts/python.exe`
3. **開始除錯**: 按 `F5` 或選擇除錯配置
4. **執行任務**: `Ctrl+Shift+P` → `Tasks: Run Task`

## 虛擬環境管理

### 設置虛擬環境
```bash
setup_venv.bat
```

### 啟動虛擬環境
```bash
activate_venv.bat
```

### 手動操作
```bash
# 創建虛擬環境
python -m venv venv

# 啟動虛擬環境 (Windows)
venv\Scripts\activate

# 安裝依賴套件
pip install -r requirements.txt

# 退出虛擬環境
deactivate
```

## 版本資訊

- **版本**：1.0
- **開發語言**：Python 3
- **GUI框架**：tkinter
- **打包工具**：PyInstaller
- **開發環境**：VSCode + Python Extension
